/**
 * Global Styles & Design System Tokens
 * 
 * Spec: /specs/013-neon-flux-design-system/spec.md
 * Tokens organized in three tiers: primitives → semantic → component
 */

/* Import design system tokens (Tier 1-3) */
@import './tokens/primitives.css';
@import './tokens/semantic.css';
@import './tokens/component.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* Neon Flux Base Styles */
  body {
    @apply bg-bg-base text-text-primary antialiased;
    font-family:
      'Inter',
      -apple-system,
      BlinkMacSystemFont,
      'Segoe UI',
      sans-serif;
    line-height: 1.6;
    min-height: 100vh;
  }

  /* Animated gradient background (Neon Flux signature) */
  body::before {
    content: '';
    position: fixed;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle at 20% 50%, hsla(277, 92%, 62%, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 80% 80%, hsla(330, 81%, 60%, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 40% 20%, hsla(221, 91%, 60%, 0.1) 0%, transparent 50%);
    animation: gradient-shift 15s ease infinite;
    z-index: -1;
    pointer-events: none;
  }

  @keyframes gradient-shift {
    0%,
    100% {
      transform: translate(0, 0);
    }
    50% {
      transform: translate(-10%, 10%);
    }
  }

  /* Prevent transitions during theme switch to avoid flash */
  .theme-switching * {
    transition: none !important;
  }
}

@layer components {
  /* Message appearance animation (Neon Flux) */
  @keyframes message-appear {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-message-appear {
    animation: message-appear 0.4s ease;
  }

  /* Chat typography optimizations */
  .prose-chat {
    @apply text-chat-body;
    max-width: 65ch;
  }

  .prose-chat h1 {
    @apply text-2xl font-bold leading-tight mb-3;
  }

  .prose-chat h2 {
    @apply text-xl font-semibold leading-snug mb-2;
  }

  .prose-chat h3 {
    @apply text-lg font-semibold leading-normal mb-2;
  }

  .prose-chat h4 {
    @apply text-base font-semibold leading-normal mb-2;
  }

  .prose-chat code {
    @apply font-mono text-chat-code-inline bg-code-inline-bg px-1 py-0.5 rounded;
  }

  .prose-chat pre {
    @apply bg-code-block-bg border border-code-block-border rounded-lg p-4 overflow-x-auto;
  }

  .prose-chat pre code {
    @apply bg-transparent p-0 text-chat-code;
  }

  .prose-chat a {
    @apply text-link hover:text-link-hover underline;
  }

  /* Typing indicator animations (Neon Flux - glowing dots) */
  .typing-dot {
    @apply w-2 h-2 rounded-full;
    background: hsl(221, 91%, 60%); /* Blue #3b82f6 */
    box-shadow: 0 0 10px hsl(221, 91%, 60%);
    animation: typing-glow 1.4s ease-in-out infinite;
  }

  .typing-dot-delay-1 {
    animation-delay: 0.2s;
  }

  .typing-dot-delay-2 {
    animation-delay: 0.4s;
  }

  .typing-pulse {
    @apply w-3 h-3 rounded-full;
    background: hsl(221, 91%, 60%);
    box-shadow: 0 0 12px hsl(221, 91%, 60%);
    animation: typing-pulse 1.5s ease-in-out infinite;
  }

  @keyframes typing-glow {
    0%,
    60%,
    100% {
      transform: translateY(0);
      opacity: 0.7;
    }
    30% {
      transform: translateY(-10px);
      opacity: 1;
    }
  }

  @keyframes typing-pulse {
    0%,
    100% {
      transform: scale(1);
      opacity: 0.6;
    }
    50% {
      transform: scale(1.3);
      opacity: 0.3;
    }
  }

  /* Custom scrollbar for chat messages (Neon Flux) */
  .chat-messages {
    scrollbar-width: thin;
    scrollbar-color: hsl(277, 92%, 62%, 0.5) transparent;
  }

  .chat-messages::-webkit-scrollbar {
    width: 8px;
  }

  .chat-messages::-webkit-scrollbar-track {
    background: transparent;
  }

  .chat-messages::-webkit-scrollbar-thumb {
    background: hsl(277, 92%, 62%, 0.5); /* Purple 50% opacity */
    border-radius: 4px;
  }

  .chat-messages::-webkit-scrollbar-thumb:hover {
    background: hsl(277, 92%, 62%, 0.7); /* Purple 70% opacity on hover */
  }
}
